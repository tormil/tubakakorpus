<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2024-05-07" />
  <title>lopuprojekt_Lust</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">lopuprojekt_Lust</h1>
<p class="date">2024-05-07</p>
</header>
<h2 id="tubakavabrikute-tubakareklaamide-analüüs">Tubakavabrikute
tubakareklaamide analüüs</h2>
<h3 id="sissejuhatus">Sissejuhatus</h3>
<p>Kuigi tubakas oli eestlastele tuttav juba 19. sajandil, hakkas
tubakatööstus Eestis arenema peamiselt pärast Vabadussõda. Esimesed
tubakatehased rajati Eestis 1920. aastatel. Juba sel ajal olid
paberosside ja muude tubakatoodete reklaamid olemas, aga need olid üsna
pinnapealsed. 1930. aastatel hakkasid kujunema erinevad reklaamivõtted,
mis mulle huvi pakkusid. Sigarettidel ja paberossidel kasutati ostjate
meelitamiseks kuulsate tegelaste nimesid, sündmusi, asukohti,
hedonistlikke termineid nagu mõnu ja nauding. Kui ajakirjanikud juba
1930ndatel kirjutasid tubaka kahjulikkusest, siis leidsid tootjad
lahenduse, rõhutades reklaamides, et nende paberossid on kahekordse
vatiga, nende paberossides puudub nikotiinimürk või, et nende tubakas on
pneumaatilise seadmega tolmust ja kahjulikest lisanditest puhastatud</p>
<p>Siin projektis kavatsen uurida erinevate tubakatehaste tubakareklaame
kasutades peamiselt aega reklaamide mõõtevahendina. Teised tunnused, mis
ajalisele skaalale panen on: reklaamide hulk, ettevõtete hulk
reklaamides ning pneumaatiliste masinate mainimine tubakareklaamides.
Eraldi tunnusena võrdlen ka tähepikkust ettevõtete reklaamtekstidel (ei
saanud sõnahulka kasutada). Töö lõpus tegin ilma testimiseta niisama
sõnasagedusi.</p>
<h3 id="mis-andmeid-kasutan">Mis andmeid kasutan?</h3>
<p>Kasutatud andmestikud on õppejõud Peeter Tinitsalt eraldi küsitud
andmestikud, mis ta saatis mulle DIGARist pakituna 1930.- 1939. kõikide
ajalehtede andmestiku koos metainfoga. 1930_all_pages_clean3.txt, mis on
mahult 6 GB, sisaldab terve ajalehe sisu ilma, et tekstid oleksid
kategoriseeritud kas “ARTICLE” VÕI “ADVERTISEMENT” alla.</p>
<p>Umbes pooled artiklid 1930. aastatest on kategoriseeritud, seega
otsustasin töös väiksema, aga kvaliteetsema valimiga töötada. Selleks
valimiks sai 1930_all_articles_clean3.txt ja
1930_meta_all_articles_clean3.tsv kombinatsioon, mis tähendab siis
1930ndate umbes pooled kõik ajalehtede väljavõtud.</p>
<p>Projektis kasutusel olevad ajalehed: Edasi: Peterburi eestlaste
ajaleht, Eesti Spordileht, Esmaspäev, Film ja Elu, Herold, Järva
Teataja, Jutuleht, Kaja, Läänehääl, Lääneteataja, Maahääl, Nõmme Sõna,
Nool, Päevaleht, Sakala, Uus Eesti Pärnu Uudised, Ühistegelised Uudised,
Üleriiklise Kaupmeeste Seltside Keskliidu Teated, Uus Eesti.</p>
<p>Kui andmestik on liiga väike mõnel ettevõttel, siis nende väiksemate
ettevõtete reklaame otsin vaid üldistes analüüsides.</p>
<p>Töös analüüsitud ettevõtted: AS “Laferme”, AS “Astoria”, “ETK” ehk
Eesti Tarvitajate Keskühisus, AS “H. Anton ja Ko”, AS “A. Reier ja Ko”,
OÜ “Havanna”, “E. Steinberg ja Ko”, AS “Regina” ja “B. Katlama”.</p>
<h3 id="mis-on-uurimisküsimus">Mis on uurimisküsimus?</h3>
<p>Uurimisküsimuseks on leida, milline ettevõte kõige rohkem enda
tooteid reklaamis, kuidas reklaamide hulk 10 aasta jooksul välja nägi,
kuidas tubaka tolmust puhastamist mainiti ning tekstipikkust ettevõtete
vahel.</p>
<h3 id="millist-meetodit-kasutan-miks">Millist meetodit kasutan?
Miks?</h3>
<p>Kasutan ajalisteks analüüsideks lineaarset regressiooni mudelit, kuna
seal saab ühe sõltumatu ja ühe sõltuva tunnusega asju uurida.</p>
<hr />
<h4
id="laadida-kõik-andmestikud-ning-võtta-kõik-vajalikud-vahendid-kasutusele">1.
Laadida kõik andmestikud ning võtta kõik vajalikud vahendid
kasutusele</h4>
<pre class="{r}"><code>library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)
library(data.table)
metaartiklid &lt;- fread(&quot;1930_meta_all_articles_clean3.tsv&quot;)
col_names &lt;- c(&quot;LogicalSectionID&quot;, &quot;content&quot;)
artiklidsisu &lt;- fread(&quot;1930_all_articles_clean3.txt&quot;, col.names = col_names)
#uhendatud ühendab metainfo ja artiklisisu ühte data frame&#39;i, võib võtta veidi aega.
uhendatud &lt;- merge(metaartiklid, artiklidsisu, by = &quot;LogicalSectionID&quot;)
#alakategooria veel väiksemaks valimiks (2981 reklaamteksti)
tubakareklaamid &lt;- uhendatud[(uhendatud$LogicalSectionType == &quot;ADVERTISEMENT&quot;) &amp; grepl(&quot;tubaka&quot;, uhendatud$content), ]</code></pre>
<p><br></p>
<h4 id="tubakareklaamide-arv-aastate-lõikes">2. Tubakareklaamide arv
aastate lõikes</h4>
<p>Esmalt kontrollime, kui palju on üleüldse reklaamiveergude arv
andmestiku kõikide ajalehtede peale kokku ning siis vaatame, kui palju
esineb reklaame, kus sõna “tubakas” esineb.</p>
<p>Nullhüpotees (H0): Tubakareklaamide hulk ei muutu aastate lõikes.
Alternatiive hüpotees (H1): Tubakareklaamide hulk muutub aastate lõikes.
Selle kontrollimiseks kasutan regressioonimudelit, kus “year” on
sõltumatu muutuja ning “tubaka_reklaamide_arv” on sõltuv muutuja.</p>
<pre class="{r}"><code>library(lmtest)
#kõikide reklaamide arv
reklaamide_arv &lt;- uhendatud %&gt;%
  group_by(year) %&gt;%
  summarise(reklaamide_arv = n())
print(reklaamide_arv)

#kõikide tubakareklaamide arv
tubaka_reklaamide_arv &lt;- tubakareklaamid %&gt;%
  group_by(year) %&gt;%
  summarise(tubaka_reklaamide_arv = n())
print(tubaka_reklaamide_arv)

#graafik lineaarse regressiooniga
plot(tubaka_reklaamide_arv$year, tubaka_reklaamide_arv$tubaka_reklaamide_arv, 
     xlab=&quot;Aasta&quot;, ylab=&quot;Reklaamide arv&quot;, 
     main=&quot;Tubakareklaamide arv aastate lõikes&quot;)
m &lt;- lm(tubaka_reklaamide_arv ~ year, data = tubaka_reklaamide_arv)
abline(m, col=&quot;red&quot;)

#mudeli kokkuvõte ja eelduste kontroll
summary(m)
bptest(m)
</code></pre>
<p>Mudeli järgi väheneb tubakareklaamide arv iga aastaga umbes 43.59
ühiku võrra. P-väärtus (0.02378) on statistiliselt oluline, mis tõendab,
et tubakareklaamide arv on seotud aastatega.</p>
<p>Breuschi-Pagani test kontrollib heteroskedastsust, mille p-väärtuseks
on 0.05119 ehk me ei lükka tagasi nullhüpoteesi, et mudeli jääkide
variatsioon on konstante.</p>
<p>Proovime mudelit uuesti, võttes liiga järsu aasta (1930.) välja.</p>
<pre class="{r}"><code>tubakareklaamidilma1930 &lt;- tubakareklaamid %&gt;%
  filter(year != 1930)

tubaka_reklaamide_arvilma &lt;- tubakareklaamidilma1930 %&gt;%
  group_by(year) %&gt;%
  summarise(tubaka_reklaamide_arv = n())
print(tubaka_reklaamide_arvilma)

#graafik lineaarse regressiooniga
plot(tubaka_reklaamide_arvilma$year, tubaka_reklaamide_arvilma$tubaka_reklaamide_arv, 
     xlab=&quot;Aasta&quot;, ylab=&quot;Reklaamide arv&quot;, 
     main=&quot;Tubakareklaamide arv aastate lõikes&quot;)
m &lt;- lm(tubaka_reklaamide_arv ~ year, data = tubaka_reklaamide_arvilma)
abline(m, col=&quot;red&quot;)

#mudeli kokkuvõte ja eelduste kontroll
summary(m)
bptest(m)

# ANOVA test
anova_model &lt;- aov(tubaka_reklaamide_arv ~ factor(year), data = tubaka_reklaamide_arv)
summary(anova_model)
anova(m)

</code></pre>
<p>Nüüd väheneb mudeli järgi reklaamide arv iga aastaga 17.867 ühiku
võrra. Tähendab, et aja jooksul on tubakareklaamide arv vähenenud. R
ruut on 0.5412 ehk mõõdukalt seletatav varieeruvus (54.12%)</p>
<p>P-väärtus (0.02378) on ikkagist statistiliselt oluline, mis tõendab,
et tubakareklaamide arv on seotud aastatega.</p>
<p>Breuschi-Pagani test kontrollib heteroskedastsust, mille p-väärtus
kasvas ehk me ei lükka tagasi nullhüpoteesi, et mudeli jääkide
variatsioon on konstante.</p>
<p>ANOVA test (p-väärtus 0.02387) näitab, et reklaamide hulk erineb
aastati.</p>
<p>Võib kokku võtta, et reklaamid, kus sees oli sõna “tubakas” vähenesid
aastate jooksul statistiliselt olulisel määral.</p>
<p><br></p>
<h4
id="tubakareklaamide-pneumaatiliste-masinate-kasutuselevõtu-mainimise-osakaal">3.
Tubakareklaamide pneumaatiliste masinate kasutuselevõtu mainimise
osakaal</h4>
<p>Esimene asi, mis reklaame uurides silma paistis, oli pidev mainimine
pneumaatilisest seadmest, kus kirjeldati, et nende tubakas on
pneumaatilise seadmega tolmust ja kahjulikest lisanditest puhastatud.
Tüüpiline väljavõte: “Kõik meie vabrikus ümbertöötatavad tubakad
puhastatakse pneumaatilisel viisil kõigest tolmust ja teistest
kahjulikkudest lisandustest.”</p>
<p>Artiklites kirjeldati, kuidas see tolm muidu rändas suitsetajate
kopsudesse. (Vaba Maa 10.04.1930, „Kaks miljonit päevas“; Eesti tööstus
&amp; kaubandus: sõnas ja pildis I. Toimetaja J. Järv. Eesti Kirjastus.
Tallinn 1931, lk. 51-52. )</p>
<p>Sarnane mõõtmine eelmisele, aga teise sõnaga. Sõltumatuks muutujaks
ikka “year” ja sõltuvaks muutujaks “pneumaat_mainimiste_arv”.</p>
<p>Nullhüpotees (H0): Pneumaatiliste masinate mainimine
tubakareklaamides ei ole seotud aastaga. Alternatiivne hüpotees (H1):
Pneumaatiliste masinate mainimine tubakareklaamides on negatiivselt
seotud aastaga (st mida varasem aasta, seda rohkem mainimisi).</p>
<pre class="{r}"><code>#Teeme pneumaatiliste seadmete mainimisest column&#39;i
tubakareklaamid$pneumaat &lt;- tubakareklaamid$content %&gt;%
  gsub(&quot;&lt;p&gt;&quot;, &quot;@@@@&lt;p&gt;&quot;, .) %&gt;% 
  gsub(&quot;&lt;\\/p&gt;&quot;, &quot;&lt;/p&gt;@@@@&quot;, .) %&gt;% 
  str_split(., &quot;@@@@&quot;) %&gt;% 
  lapply(., function(x) x %&gt;% 
          grep(&quot;p *n *e *u *m *a *a *t&quot;, ., ignore.case = T, value = T) %&gt;% 
          paste(., collapse = &quot; &quot;)) %&gt;% 
  unlist()

#kategoriseerida testi jaoks
pneumaat_mainimiste_arv &lt;- tubakareklaamid %&gt;%
  group_by(year) %&gt;%
  summarise(pneumaat_mainimiste_arv = sum(nchar(pneumaat) &gt; 0))

#print(pneumaat_mainimiste_arv)


#graafik
plot(pneumaat_mainimiste_arv$year, pneumaat_mainimiste_arv$pneumaat_mainimiste_arv, 
     xlab=&quot;Aasta&quot;, ylab=&quot;Pneumaatiliste masinate mainimiste arv&quot;, 
     main=&quot;Pneumaatiliste reklaamide hulk&quot;,
     pch = ifelse(pneumaat_mainimiste_arv$pneumaat_mainimiste_arv == 0, 4, 1))


pneu.m &lt;- lm(pneumaat_mainimiste_arv ~ year, data = pneumaat_mainimiste_arv)
abline(pneu.m, col=&quot;red&quot;)
#mudeli kokkuvõte ja eelduste kontroll
summary(pneu.m)
bptest(pneu.m)


tubakareklaamidilma1932 &lt;- tubakareklaamid %&gt;%
  filter(year != 1930 &amp; year != 1931 &amp; year != 1932)

pneumaat_mainimiste_arvilma &lt;- tubakareklaamidilma1932 %&gt;%
  group_by(year) %&gt;%
  summarise(pneumaat_mainimiste_arv = sum(nchar(pneumaat) &gt; 0))

#teine graafik, et lähemalt näha hilisemaid numbreid
plot(pneumaat_mainimiste_arvilma$year, pneumaat_mainimiste_arvilma$pneumaat_mainimiste_arv, 
     xlab=&quot;Aasta&quot;, ylab=&quot;Pneumaatiliste masinate mainimiste arv&quot;, 
     main=&quot;Pneumaatiliste reklaamide hulk&quot;,
     pch = ifelse(pneumaat_mainimiste_arvilma$pneumaat_mainimiste_arv == 0, 4, 1))
</code></pre>
<p>Siin on näha, et pneumaatiliste sisseseadete mainimine kukkus
drastiliselt pärast esimest aastat. 1937-1939 ei mainitud seda üldse.
Keskmiselt on pneumaatiliste masinate mainimine vähenenud 23.09 ühiku
võrra. P-väärtus on üle 0.05, ehk see ei ole statistiliselt oluline.
Siit ei leitud korralikku heteroskedastsust, vaid liiga laiali olevaid
“juhuslikke” andmeid. Mudeli testid näitavad, et liiga drastiline hüpe
ning liiga väike valim hilisematel aastatel.</p>
<p><br></p>
<h4 id="tubakaettevõtted">4.Tubakaettevõtted</h4>
<p>Võtame nüüd uurimisaluseks tubakaettevõtted, vaatame esialgu
esinemissagedust ning viskame väiksemad firmad analüüsist välja:</p>
<pre class="{r}"><code>#Võtame ära kombineeritud reklaamid
tubakareklaamid$content &lt;- tubakareklaamid$content %&gt;%
  gsub(&quot;&lt;p&gt;&quot;, &quot;@@@@&lt;p&gt;&quot;, .) %&gt;% # lisa lõigu algusmärgendi ette @@@@
  gsub(&quot;&lt;\\/p&gt;&quot;, &quot;&lt;/p&gt;@@@@&quot;, .) %&gt;% # lisa lõigu lõpumärgendi järele @@@@
  str_split(., &quot;@@@@&quot;) %&gt;% # lõika iga lahtri tekst @@@@ koha pealt tükkideks (igast lahtri lõigust tekib listi element)
  lapply(., function(x) x %&gt;% # iga lahtri puhul
          grep(&quot;tubaka&quot;, ., ignore.case = T, value = T) %&gt;% # jäta alles ainult lõik, mis sisaldab otsitavat tekstijärjendit
          paste(., collapse = &quot; &quot;)) %&gt;% # kui sobivaid lõike on mitu, kleebi need kokku
  unlist() # tee lahtrite listist tekstivektor, mis oleks sama pikk, kui algne tubakareklaamid$content vektor

######################KÕIKIDE TUBAKAREKLAAMIDE FIRMADESAGEDUS
ettevotted &lt;- c(&quot;Laferme&quot;, &quot;Sirena&quot;, &quot;Katlama&quot;, &quot;Regina&quot;, &quot;Havanna&quot;, &quot;Sultan Flor&quot;, &quot;Reier&quot;, &quot;Astoria&quot;, &quot;Anton&quot;, &quot;Kungla&quot;, &quot;Steinberg&quot;, &quot;Leo Scheer&quot;, &quot;Osman&quot;)
#Ettevõtetesse ei lisanud ETK, Eslon ega Aino, sest tuli välja, et kood köhis valed andmed, sain Aino&#39;ga mainitu vaid teise #ettevõtte paberossimargi &quot;Aino&quot; ning &quot;ETK&quot; polnud reklaamiga seotud, &quot;Eslon&quot; oli valesti loetud sõnast &quot;ESLonia&quot;
firmadelist_koik &lt;- list()
for (ettevote in ettevotted) {
  ettevote &lt;- gsub(&quot;\\[ja&amp;\\]&quot;, &quot;ja|&amp;&quot;, ettevote)
  ettevote &lt;- gsub(&quot;\\[AE\\]&quot;, &quot;A|E&quot;, ettevote)
  firmadelist_koik[[ettevote]] &lt;- tubakareklaamid[grepl(ettevote, tubakareklaamid$content, ignore.case = TRUE, perl = TRUE), ]
}

firmamainimine_koik &lt;- data.frame(Ettevote = character(), LeitudRidadeArv = numeric())
for (ettevote in names(firmadelist_koik)) {
  firmamainimine_koik &lt;- rbind(firmamainimine_koik, data.frame(Ettevote = ettevote, LeitudRidadeArv = nrow(firmadelist_koik[[ettevote]])))
}

firmamainimine_koik &lt;- firmamainimine_koik %&gt;% filter(LeitudRidadeArv != 0)
ggplot(firmamainimine_koik, aes(y = reorder(Ettevote, LeitudRidadeArv), x = LeitudRidadeArv)) +
  geom_bar(stat = &quot;identity&quot;) +
  scale_y_discrete(labels = c(&quot;Reier&quot; = &quot;A. Reier ja Ko&quot;, &quot;Anton&quot; = &quot;H. Anton ja Ko&quot;, &quot;Steinberg&quot; = &quot;E. Steinberg ja Ko&quot;)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(y = &quot;Ettevõte&quot;, x = &quot;Ettevõtete nime mainitud arv&quot;, title = &quot;Ettevõtete osakaal kõikides tubakareklaamides&quot;)</code></pre>
<p>Nüüd jätame väiksemad firmad välja ning analüüsime firmasid aastate
peale.</p>
<p>Nullhüpotees (H0): Ettevõtte mainimiste arv tubakareklaamides ei ole
seotud aastaga. Alternatiivne hüpotees (H1): Ettevõtte mainimiste arv
tubakareklaamides on seotud aastaga.</p>
<pre class="{r}"><code>
#Suuremate ettevõtete nimekiri
firmanimed &lt;- c(&quot;Laferme&quot;, &quot;Sirena&quot;, &quot;Regina&quot;, &quot;Havanna&quot;, &quot;Astoria&quot;, &quot;Anton&quot;)

for (nimi in firmanimed) {
  tubakareklaamid[[nimi]] &lt;- tubakareklaamid$content %&gt;%
    gsub(&quot;&lt;p&gt;&quot;, &quot;@@@@&lt;p&gt;&quot;, .) %&gt;%
    gsub(&quot;&lt;\\/p&gt;&quot;, &quot;&lt;/p&gt;@@@@&quot;, .) %&gt;%
    str_split(., &quot;@@@@&quot;) %&gt;%
    lapply(., function(x) x %&gt;%
             grep(nimi, ., ignore.case = TRUE, value = TRUE) %&gt;%
             paste(., collapse = &quot; &quot;)) %&gt;%
    unlist()
  
  assign(paste0(nimi, &quot;_mainimiste_arv&quot;), tubakareklaamid %&gt;%
           group_by(year) %&gt;%
           summarise(mainimiste_arv = sum(nchar(get(nimi)) &gt; 0)))
  
  plot(get(paste0(nimi, &quot;_mainimiste_arv&quot;))$year, get(paste0(nimi, &quot;_mainimiste_arv&quot;))$mainimiste_arv, 
       xlab=&quot;Aasta&quot;, ylab=paste0(nimi, &quot; mainimiste arv&quot;), 
       main=paste0(nimi, &quot; reklaamide hulk&quot;),
       pch = ifelse(get(paste0(nimi, &quot;_mainimiste_arv&quot;))$mainimiste_arv == 0, 4, 1))

  fir.m &lt;- lm(mainimiste_arv ~ year, data = get(paste0(nimi, &quot;_mainimiste_arv&quot;)))
  abline(fir.m, col=&quot;red&quot;)

  print(summary(fir.m))
  print(bptest(fir.m))
}</code></pre>
<p>Panin eraldi ka ploti, kus kõik on koos</p>
<pre class="{r}"><code>
kogu_mainimiste_arv &lt;- bind_rows(lapply(firmanimed, function(nimi) get(paste0(nimi, &quot;_mainimiste_arv&quot;)) %&gt;% mutate(firma = nimi)))

ggplot(data = kogu_mainimiste_arv) +
  geom_line(aes(x = year, y = mainimiste_arv, group = firma, color = firma), size = 1.5) +
  scale_x_continuous(breaks = seq(min(kogu_mainimiste_arv$year), max(kogu_mainimiste_arv$year), by = 1)) + 
  theme_light() +
  labs(x = &quot;Aasta&quot;,
       y = &quot;Mainimiste arv&quot;,
       title = &quot;Firmade mainimiste arv aastate lõikes&quot;)
</code></pre>
<p>Iga aasta kohta väheneb ettevõtte mainimiste arv keskmiselt 3.158
ühiku võrra. P-väärtused on üle 0.05, ehk tähendab jälle, et ei ole
statistiliselt oluline. Heteroskedastsust ei ole.</p>
<p><br></p>
<h4 id="tubakaettevõtete-reklaamtekstide-keskmine-pikkus">5.
Tubakaettevõtete reklaamtekstide keskmine pikkus</h4>
<pre class="{r}"><code>
for (nimi in firmanimed) {
  tubakareklaamid[[nimi]] &lt;- tubakareklaamid$content %&gt;%
    gsub(&quot;&lt;p&gt;&quot;, &quot;@@@@&lt;p&gt;&quot;, .) %&gt;%
    gsub(&quot;&lt;\\/p&gt;&quot;, &quot;&lt;/p&gt;@@@@&quot;, .) %&gt;%
    str_split(., &quot;@@@@&quot;) %&gt;%
    lapply(., function(x) x %&gt;%
             grep(nimi, ., ignore.case = TRUE, value = TRUE) %&gt;%
             paste(., collapse = &quot; &quot;)) %&gt;%
    unlist()
  
  assign(paste0(nimi, &quot;_keskmine_pikkus&quot;), tubakareklaamid %&gt;%
           mutate(pikkus = nchar(get(nimi))) %&gt;%
           group_by(year) %&gt;%
           summarise(keskmine_pikkus = mean(pikkus, na.rm = TRUE)))
  plot(get(paste0(nimi, &quot;_keskmine_pikkus&quot;))$year, get(paste0(nimi, &quot;_keskmine_pikkus&quot;))$keskmine_pikkus, 
       xlab=&quot;Aasta&quot;, ylab=paste0(nimi, &quot; keskmine pikkus&quot;), 
       main=paste0(nimi, &quot; reklaamide hulk&quot;),
       pch = ifelse(get(paste0(nimi, &quot;_keskmine_pikkus&quot;))$keskmine_pikkus == 0, 4, 1))

  pikk.m &lt;- lm(keskmine_pikkus ~ year, data = get(paste0(nimi, &quot;_keskmine_pikkus&quot;)))
  abline(pikk.m, col=&quot;red&quot;)

  print(summary(pikk.m))
  print(bptest(pikk.m))
}</code></pre>
<pre class="{r}"><code>#suur ggplot, vajadusel kasutada kui crashib
kogu_keskmine_pikkus &lt;- bind_rows(lapply(firmanimed, function(nimi) get(paste0(nimi, &quot;_keskmine_pikkus&quot;)) %&gt;% mutate(firma = nimi)))

library(ggplot2)
ggplot(data = kogu_keskmine_pikkus) +
  geom_line(aes(x = year, y = keskmine_pikkus, group = firma, color = firma), size = 1.5) +
  scale_x_continuous(breaks = seq(min(kogu_keskmine_pikkus$year), max(kogu_keskmine_pikkus$year), by = 1)) + 
  theme_light() +
  labs(x = &quot;Aasta&quot;,
       y = &quot;Keskmine pikkus&quot;,
       title = &quot;Firmade tubakareklaamide keskmine pikkus aastate lõikes&quot;)

</code></pre>
<p>Mudel näitab, et ükski pole statistiliselt oluline, sest kõikidel on
p-väärtus üle 0.05. Kuid siiski, iga aasta kohta väheneb keskmine
tähepikkus 1.5 kuni 2.3 ühiku võrra. Heteroskedastsuse testil on suur
varieeruvus (0.01474-0.8247), mõnel juhul rikub, mõnel mitte.</p>
<p>Kokkuvõte:</p>
<p>Tubakaettevõtete reklaamihulk vähenes drastiliselt 1931. aastal ning
jäi allapoole trendi ka edasistel aastatel. Sama lugu pneumaatiliste
sisseseadmete mainimisel, üritasin ka aktsiisidega leida seoseid, kuid
neid tulemusi oli liiga vähe. Kõige rohkem reklaamis enda tooteid
ettevõtted “Laferme”, “Sirena”, “Regina”, “Havanna”, “Astoria” ning “H.
Anton ja Ko”. Tekstipikkusega seoseid ei leidnud, välja arvatud see, et
reklaamihulga vähenemisega vähenesid ka reklaamtekstihulgad (mingist
arvust nulli peale). Midagi siin töös tundus kahtlane, see järsk
tubakareklaamide vähenemine 1930. aastast ning mu kasutatud lineaarse
regressiooni mudel ka kõige parem vist ei olnud.</p>
<p><br></p>
<h4
id="kõikide-reklaamveergude-sõnasagedus-kus-esineb-sõna-tubakas.">Kõikide
reklaamveergude sõnasagedus, kus esineb sõna “tubakas”.</h4>
<pre class="{r}"><code>#########KÕIKIDE TUBAKAREKLAAMDIE SÕNASAGEDUSLOEND
#Sõnasageduse loend
library(tidytext)
stoppsonad &lt;- readLines(&quot;http://kodu.ut.ee/~soras/tekstikorpused/stoppsonad_rk.txt&quot;)

#Teeb sõnasageduse, võtab ära stoppsõnad, numbrid ja kuni 3 tähelised sõnad, eemaldab kõik, mille sagedus on kuni 3
sonasagedus &lt;- tubakareklaamid %&gt;%
  unnest_tokens(word, content) %&gt;%
  mutate(word = str_remove_all(word, &quot;[0-9]&quot;)) %&gt;%
  filter(nchar(word) &gt; 3) %&gt;%
  anti_join(data.frame(word = stoppsonad)) %&gt;%
  count(word, sort = TRUE) %&gt;%
  filter(n &gt; 3)

ggplot(sonasagedus[1:30, ], aes(x = reorder(word, n), y = n)) +
  geom_col() +
  coord_flip() +
  labs(x = &quot;Sõna&quot;, y = &quot;Sagedus&quot;, title = &quot;Sõnasagedus tubakareklaamveergudel&quot;)
</code></pre>
<h2 id="laferme-ettevõtte-brändisagedused-ja-sõnasagedused">Laferme
ettevõtte brändisagedused ja sõnasagedused</h2>
<pre class="{r}"><code>#Laferme nimetamised reklaamides NB! paragraafimärgistega MITTE sorteeritud
laferme_rows &lt;- tubakareklaamid[grepl(&quot;ferm&quot;, tubakareklaamid$content), ]
laferme_rows_suur &lt;- uhendatud[uhendatud$LogicalSectionType == &quot;ADVERTISEMENT&quot; &amp; grepl(&quot;laferme&quot;, uhendatud$content, ignore.case = TRUE), ]
#Laferme brändisagedus
laferme_brands &lt;- c(&quot;Baar&quot;, &quot;Stella&quot;, &quot;Diva&quot;, &quot;Niilus&quot;, &quot;Manon&quot;, &quot;Orient&quot;, &quot;Lia&quot;, &quot;Malta&quot;, &quot;Ekstra&quot;, &quot;Kasulik&quot;, &quot;Special&quot;)
tubakareklaamid$brand &lt;- str_extract(tubakareklaamid$content, str_c(laferme_brands, collapse = &quot;|&quot;))
laferme_brand_counts &lt;- tubakareklaamid %&gt;%
  count(brand, sort = TRUE)
laferme_brand_counts &lt;- laferme_brand_counts[!is.na(laferme_brand_counts$brand), ]

ggplot(laferme_brand_counts, aes(x = reorder(brand, n), y = n)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;blue&quot;, color = &quot;black&quot;) +
  coord_flip() +
  theme_minimal() +
  labs(title = &quot;Kaubamargi sagedus kasutades data frame &#39;tubakareklaamid&#39;&quot;, x = &quot;Kaubamark&quot;, y = &quot;Sagedus&quot;)

#Laferme brändisagedus suurema andmestikuga, siin tuleb miskipärast veider erisus välja.
laferme_rows_suur$brand &lt;- str_extract(laferme_rows_suur$content, str_c(laferme_brands, collapse = &quot;|&quot;))
laferme_brand_counts &lt;- laferme_rows_suur %&gt;%
  count(brand, sort = TRUE)
laferme_brand_counts &lt;- laferme_brand_counts[!is.na(laferme_brand_counts$brand), ]

ggplot(laferme_brand_counts, aes(x = reorder(brand, n), y = n)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;blue&quot;, color = &quot;black&quot;) +
  coord_flip() +
  theme_minimal() +
  labs(title = &quot;Kaubamargi sagedus kasutades data frame &#39;laferme_rows_suur&#39;&quot;, x = &quot;Kaubamark&quot;, y = &quot;Sagedus&quot;)

#Laferme reklaamide sõnasagedused

#Teeb sõnasageduse, võtab ära stoppsõnad, numbrid ja kuni 3 tähelised sõnad, eemaldab kõik, mille sagedus on kuni 3
laferme_sonasagedus &lt;- laferme_rows %&gt;%
  unnest_tokens(word, content) %&gt;%
  mutate(word = str_remove_all(word, &quot;[0-9]&quot;)) %&gt;%
  filter(nchar(word) &gt; 3) %&gt;%
  anti_join(data.frame(word = stoppsonad)) %&gt;%
  count(word, sort = TRUE) %&gt;%
  filter(n &gt; 3)

#eemaldan sõna &#39;laferme&#39; kuna seda esineb üsna palju
laferme_sonasagedus &lt;- laferme_sonasagedus[laferme_sonasagedus$word != &quot;laferme&quot;, ]

ggplot(laferme_sonasagedus[1:30, ], aes(x = reorder(word, n), y = n)) +
  geom_col() +
  coord_flip() +
  labs(x = &quot;Sõna&quot;, y = &quot;Sagedus&quot;, title = &quot;Sõnasagedus reklaamveergudel, kus leidub sõna Laferme&quot;)
</code></pre>
<h2 id="astoria-sõnasagedus">5. Astoria sõnasagedus</h2>
<pre class="{r}"><code>#firmanimed &lt;- c(&quot;Laferme&quot;, &quot;Sirena&quot;, &quot;Regina&quot;, &quot;Havanna&quot;, &quot;Astoria&quot;, &quot;Anton&quot;)
#Astoria nimetamised reklaamides, alustasin kohe suurema andmestikuga, paremad tulemused. NB! paragraafimärgistega MITTE sorteeritud
astoria_suur &lt;- tubakareklaamid[tubakareklaamid$LogicalSectionType == &quot;ADVERTISEMENT&quot; &amp; grepl(&quot;astoria&quot;, tubakareklaamid$content, ignore.case = TRUE), ]

#Teeb sõnasageduse, võtab ära stoppsõnad, numbrid ja kuni 3 tähelised sõnad, eemaldab kõik, mille sagedus on kuni 3
astoria_sonasagedus &lt;- astoria_suur %&gt;%
  unnest_tokens(word, content) %&gt;%
  mutate(word = str_remove_all(word, &quot;[0-9]&quot;)) %&gt;%
  filter(nchar(word) &gt; 3) %&gt;%
  anti_join(data.frame(word = stoppsonad)) %&gt;%
  count(word, sort = TRUE) %&gt;%
  filter(n &gt; 3)

#eemaldan sõna &#39;astoria&#39; kuna seda esineb üsna palju
astoria_sonasagedus &lt;- astoria_sonasagedus[astoria_sonasagedus$word != &quot;astoria&quot;, ]

ggplot(astoria_sonasagedus[1:30, ], aes(x = reorder(word, n), y = n)) +
  geom_col() +
  coord_flip() +
  labs(x = &quot;Sõna&quot;, y = &quot;Sagedus&quot;, title = &quot;Sõnasagedus reklaamveergudel, kus leidub sõna Astoria&quot;)</code></pre>
<pre class="{r}"><code># Sirena
sirena_suur &lt;- tubakareklaamid[tubakareklaamid$LogicalSectionType == &quot;ADVERTISEMENT&quot; &amp; grepl(&quot;sirena&quot;, tubakareklaamid$content, ignore.case = TRUE), ]
sirena_sonasagedus &lt;- sirena_suur %&gt;%
  unnest_tokens(word, content) %&gt;%
  mutate(word = str_remove_all(word, &quot;[0-9]&quot;)) %&gt;%
  filter(nchar(word) &gt; 3) %&gt;%
  anti_join(data.frame(word = stoppsonad)) %&gt;%
  count(word, sort = TRUE) %&gt;%
  filter(n &gt; 3)
sirena_sonasagedus &lt;- sirena_sonasagedus[sirena_sonasagedus$word != &quot;sirena&quot;, ]
ggplot(sirena_sonasagedus[1:30, ], aes(x = reorder(word, n), y = n)) +
  geom_col() +
  coord_flip() +
  labs(x = &quot;Sõna&quot;, y = &quot;Sagedus&quot;, title = &quot;Sõnasagedus reklaamveergudel, kus leidub sõna Sirena&quot;)
# Regina
regina_suur &lt;- tubakareklaamid[tubakareklaamid$LogicalSectionType == &quot;ADVERTISEMENT&quot; &amp; grepl(&quot;regina&quot;, tubakareklaamid$content, ignore.case = TRUE), ]
regina_sonasagedus &lt;- regina_suur %&gt;%
  unnest_tokens(word, content) %&gt;%
  mutate(word = str_remove_all(word, &quot;[0-9]&quot;)) %&gt;%
  filter(nchar(word) &gt; 3) %&gt;%
  anti_join(data.frame(word = stoppsonad)) %&gt;%
  count(word, sort = TRUE) %&gt;%
  filter(n &gt; 3)
regina_sonasagedus &lt;- regina_sonasagedus[regina_sonasagedus$word != &quot;regina&quot;, ]
ggplot(regina_sonasagedus[1:30, ], aes(x = reorder(word, n), y = n)) +
  geom_col() +
  coord_flip() +
  labs(x = &quot;Sõna&quot;, y = &quot;Sagedus&quot;, title = &quot;Sõnasagedus reklaamveergudel, kus leidub sõna Regina&quot;)
# Havanna
havanna_suur &lt;- tubakareklaamid[tubakareklaamid$LogicalSectionType == &quot;ADVERTISEMENT&quot; &amp; grepl(&quot;havanna&quot;, tubakareklaamid$content, ignore.case = TRUE), ]
havanna_sonasagedus &lt;- havanna_suur %&gt;%
  unnest_tokens(word, content) %&gt;%
  mutate(word = str_remove_all(word, &quot;[0-9]&quot;)) %&gt;%
  filter(nchar(word) &gt; 3) %&gt;%
  anti_join(data.frame(word = stoppsonad)) %&gt;%
  count(word, sort = TRUE) %&gt;%
  filter(n &gt; 3)
havanna_sonasagedus &lt;- havanna_sonasagedus[havanna_sonasagedus$word != &quot;havanna&quot;, ]
ggplot(havanna_sonasagedus[1:30, ], aes(x = reorder(word, n), y = n)) +
  geom_col() +
  coord_flip() +
  labs(x = &quot;Sõna&quot;, y = &quot;Sagedus&quot;, title = &quot;Sõnasagedus reklaamveergudel, kus leidub sõna Havanna&quot;)
# Anton
anton_suur &lt;- tubakareklaamid[tubakareklaamid$LogicalSectionType == &quot;ADVERTISEMENT&quot; &amp; grepl(&quot;anton&quot;, tubakareklaamid$content, ignore.case = TRUE), ]
anton_sonasagedus &lt;- anton_suur %&gt;%
  unnest_tokens(word, content) %&gt;%
  mutate(word = str_remove_all(word, &quot;[0-9]&quot;)) %&gt;%
  filter(nchar(word) &gt; 3) %&gt;%
  anti_join(data.frame(word = stoppsonad)) %&gt;%
  count(word, sort = TRUE) %&gt;%
  filter(n &gt; 3)
anton_sonasagedus &lt;- anton_sonasagedus[anton_sonasagedus$word != &quot;anton&quot;, ]
ggplot(anton_sonasagedus[1:30, ], aes(x = reorder(word, n), y = n)) +
  geom_col() +
  coord_flip() +
  labs(x = &quot;Sõna&quot;, y = &quot;Sagedus&quot;, title = &quot;Sõnasagedus reklaamveergudel, kus leidub sõna Anton&quot;)
</code></pre>
</body>
</html>
